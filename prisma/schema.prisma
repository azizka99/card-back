generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model app_user {
  id         String       @id @db.Uuid
  name       String
  email      String       @unique
  role       String       @default("user")
  password   String?
  steam_card steam_card[]
  tag        tag[]
}

model steam_card {
  id              String      @id @db.Uuid
  activation_code String      @unique(map: "unique_activation_code")
  barcode         String      @unique(map: "unique_barcode")
  created_at      DateTime    @default(now()) @db.Timestamptz(6)
  img_src         String?
  user_id         String      @db.Uuid
  tag_id          String?     @db.Uuid
  pack_id         String?     @db.Uuid
  errorCard       errorCard[]
  pack            pack?       @relation(fields: [pack_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_pack")
  tag             tag?        @relation(fields: [tag_id], references: [id], onUpdate: NoAction, map: "fk_steam_card_tag")
  app_user        app_user    @relation(fields: [user_id], references: [id], onUpdate: NoAction, map: "fk_steam_card_user")
}

model tag {
  id                 String       @id @db.Uuid
  name               String       @unique
  created_at         DateTime     @default(now()) @db.Timestamptz(6)
  userId             String?      @db.Uuid
  is_activated       Boolean      @default(false)
  is_visible_to_user Boolean      @default(true)
  approved_by_user   Boolean      @default(false)
  steam_card         steam_card[]
  app_user           app_user?    @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model errorCard {
  id            String     @id @db.Uuid
  googleanswer  String?
  steam_card_id String     @db.Uuid
  steam_card    steam_card @relation(fields: [steam_card_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_steamcard")
}

model pack {
  id           String       @id @db.Uuid
  start_number String       @unique(map: "pack_start_number_unique")
  steam_card   steam_card[]
}
