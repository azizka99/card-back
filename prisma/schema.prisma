generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model app_user {
  id         String       @id @db.Uuid
  name       String
  email      String?      @unique
  created_at DateTime     @default(now()) @db.Timestamptz(6)
  role       String?      @default("client")
  auth       auth[]
  steam_card steam_card[]
}

model steam_card {
  id              String    @id @db.Uuid
  activation_code String?
  barcode         String
  created_at      DateTime  @default(now()) @db.Timestamptz(6)
  img_src         String?
  user_id         String?   @db.Uuid
  app_user        app_user? @relation(fields: [user_id], references: [id], onUpdate: NoAction)

  @@index([barcode], map: "idx_steam_card_barcode")
}

model auth {
  id               String    @id @db.Uuid
  otp              String?
  token            String?
  otp_created_at   DateTime? @default(now()) @db.Timestamptz(6)
  token_created_at DateTime? @default(now()) @db.Timestamptz(6)
  user_id          String?   @db.Uuid
  app_user         app_user? @relation(fields: [user_id], references: [id], onUpdate: NoAction)
}
